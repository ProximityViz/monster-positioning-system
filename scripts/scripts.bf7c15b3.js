"use strict";angular.module("morningtonCrescentApp",["morningtonCrescentApp.factories","ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).otherwise({redirectTo:"/"})}]),angular.module("morningtonCrescentApp").controller("MainCtrl",["$scope","$timeout","GameFactory",function(a,b,c){var d=[];a.gameInProgress=!1,a.turnInProgress=!1,a.currentPlayer=c.getCurrentPlayer(),a.currentPlayerMovable=[];var e={};a.playerOneMonsters=[],a.playerTwoMonsters=[],a.playerOneGoal={},a.legalMoves=[],a.playerOneScore=0,a.justWonGame=!1;var f=function(){a.playerOneMonsters=[],a.playerTwoMonsters=[],a.legalMoves=[],d=c.getGameBoard();for(var b=0;b<d.length;b++){var e=d[b];1===e.player?a.playerOneMonsters.push(e):2===e.player?a.playerTwoMonsters.push(e):"p1goal"===e.player&&(a.playerOneGoal=e)}},g=function(b){if(a.grabMonster(b),0!==a.legalMoves.length){var c=a.legalMoves[Math.floor(Math.random()*a.legalMoves.length)];h(c)}else{var d=a.currentPlayerMovable.indexOf(e);d>-1&&a.currentPlayerMovable.splice(d,1),a.currentPlayerMovable.length<=0&&a.endTurn()}},h=function(b){a.moveMonster(b)},i=function(){for(var b=a.currentPlayerMovable.length;b--;){var c=a.currentPlayerMovable[b];g(c)}};a.grabMonster=function(b){var c=new Audio("sounds/pick-up-piece.wav");c.play(),a.legalMoves=[],e=b;for(var f=1===a.currentPlayer?"p1goal":"p2goal",g=0;g<b.adjacent.length;g++)for(var h=0;h<d.length;h++)d[h].id===b.adjacent[g]&&(0===d[h].player||d[h].player===f)&&a.legalMoves.push(d[h])},a.moveMonster=function(b){var d=new Audio("sounds/place-piece.wav");if(d.play(),1===a.currentPlayer)if("p1goal"===b.player){var d=new Audio("sounds/portal.wav");d.play(),console.log("score"),c.playerScored(b),a.justWonGame=c.checkForWin()}else a.playerOneMonsters.push(b);else 2===a.currentPlayer&&a.playerTwoMonsters.push(b);a.playerOneScore=c.getScore(),c.moveMonsterFromTo(e,b);var f=a.currentPlayerMovable.indexOf(e);f>-1&&a.currentPlayerMovable.splice(f,1),a.legalMoves=[],a.currentPlayerMovable.length<=0&&a.endTurn()};var j=function(){a.turnInProgress=!0,1===a.currentPlayer?(console.log("player 1 turn begins"),a.currentPlayerMovable=a.playerOneMonsters,a.playerOneMonsters=[]):2===a.currentPlayer&&(console.log("player 2 turn begins"),a.currentPlayerMovable=a.playerTwoMonsters,a.playerTwoMonsters=[],b(function(){i()},3e3))};a.endTurn=function(){a.turnInProgress=!1,c.changeTurn(),a.currentPlayer=c.getCurrentPlayer(),f(),j()},a.startGame=function(){console.log("start"),a.playerOneScore=c.getScore(),c.startNewGame(),a.gameInProgress=!0,a.currentPlayer=c.getCurrentPlayer(),f(),j()}}]),angular.module("morningtonCrescentApp").controller("AboutCtrl",function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}),angular.module("morningtonCrescentApp.factories",[]).factory("GameFactory",function(){var a=[],b=0,c=0,d=function(){b=1,a[Math.floor(Math.random()*a.length)].player="p1goal"},e=function(){c=0,a=[{id:1,adjacent:[2],coordinates:[178,631],player:0},{id:2,adjacent:[1,3],coordinates:[222,631],player:0},{id:3,adjacent:[2,4],coordinates:[267,631],player:0},{id:4,adjacent:[3,5,57],coordinates:[325,641],player:0},{id:5,adjacent:[4,6],coordinates:[367,641],player:0},{id:6,adjacent:[5,7],coordinates:[399,641],player:0},{id:7,adjacent:[6,8],coordinates:[431,641],player:0},{id:8,adjacent:[7,9],coordinates:[465,641],player:0},{id:9,adjacent:[8,10,51],coordinates:[513,593],player:0},{id:10,adjacent:[9,11],coordinates:[628,530],player:0},{id:11,adjacent:[10,12],coordinates:[663,530],player:0},{id:12,adjacent:[11,13],coordinates:[729,530],player:0},{id:13,adjacent:[12,14,55,88],coordinates:[764,592],player:0},{id:14,adjacent:[13,15],coordinates:[764,637],player:0},{id:15,adjacent:[14,16],coordinates:[765,673],player:0},{id:16,adjacent:[15,17,50,54,67],coordinates:[857,711],player:0},{id:17,adjacent:[16,18],coordinates:[909,711],player:0},{id:18,adjacent:[17,19],coordinates:[955,711],player:0},{id:19,adjacent:[18,20],coordinates:[998,704],player:0},{id:20,adjacent:[19,21],coordinates:[1023,678],player:0},{id:21,adjacent:[20,22,38],coordinates:[1073,667],player:0},{id:22,adjacent:[21,23],coordinates:[1157,633],player:0},{id:23,adjacent:[22,24],coordinates:[1185,607],player:0},{id:24,adjacent:[23,25],coordinates:[1212,579],player:0},{id:25,adjacent:[24,26],coordinates:[1239,551],player:0},{id:26,adjacent:[25],coordinates:[1267,525],player:0},{id:27,adjacent:[28],coordinates:[45,381],player:0},{id:28,adjacent:[27,29],coordinates:[67,403],player:0},{id:29,adjacent:[28,30],coordinates:[89,425],player:0},{id:30,adjacent:[29,31],coordinates:[110,448],player:0},{id:31,adjacent:[30,32],coordinates:[133,470],player:0},{id:32,adjacent:[31,33],coordinates:[156,492],player:0},{id:33,adjacent:[32,34],coordinates:[178,514],player:0},{id:34,adjacent:[33,35],coordinates:[201,537],player:0},{id:35,adjacent:[34,36],coordinates:[223,560],player:0},{id:36,adjacent:[35,37],coordinates:[245,583],player:0},{id:37,adjacent:[4,36],coordinates:[267,605],player:0},{id:38,adjacent:[21,39],coordinates:[1204,678],player:0},{id:39,adjacent:[38,40],coordinates:[1239,678],player:0},{id:40,adjacent:[39,41],coordinates:[1273,678],player:0},{id:41,adjacent:[40,42],coordinates:[1306,678],player:0},{id:42,adjacent:[41],coordinates:[1339,678],player:0},{id:43,adjacent:[44],coordinates:[490,1195],player:0},{id:44,adjacent:[43,45],coordinates:[549,1123],player:0},{id:45,adjacent:[44,46,53],coordinates:[731,1085],player:0},{id:46,adjacent:[45,47],coordinates:[731,1034],player:0},{id:47,adjacent:[46,48],coordinates:[730,998],player:0},{id:48,adjacent:[47,49],coordinates:[682,969],player:0},{id:49,adjacent:[48,50],coordinates:[655,919],player:0},{id:50,adjacent:[16,49,51],coordinates:[656,858],player:0},{id:51,adjacent:[9,50],coordinates:[590,768],player:0},{id:52,adjacent:[53],coordinates:[741,1196],player:0},{id:53,adjacent:[45,52],coordinates:[742,1142],player:0},{id:54,adjacent:[16,55],coordinates:[856,639],player:0},{id:55,adjacent:[13,54,56,94],coordinates:[855,590],player:0},{id:56,adjacent:[55,57],coordinates:[856,540],player:0},{id:57,adjacent:[56,58],coordinates:[856,496],player:0},{id:58,adjacent:[57,59],coordinates:[820,455],player:0},{id:59,adjacent:[58,60],coordinates:[785,413],player:0},{id:60,adjacent:[59,61],coordinates:[820,380],player:0},{id:61,adjacent:[60,62,89,98],coordinates:[899,354],player:0},{id:62,adjacent:[61,63],coordinates:[945,306],player:0},{id:63,adjacent:[62,64],coordinates:[973,278],player:0},{id:64,adjacent:[63,65],coordinates:[1e3,251],player:0},{id:65,adjacent:[64],coordinates:[1029,221],player:0},{id:67,adjacent:[16,68],coordinates:[904,834],player:0},{id:68,adjacent:[67,69],coordinates:[939,834],player:0},{id:69,adjacent:[68,70],coordinates:[1005,860],player:0},{id:70,adjacent:[69,71],coordinates:[1029,881],player:0},{id:71,adjacent:[70,72],coordinates:[1062,903],player:0},{id:72,adjacent:[71,73],coordinates:[1108,894],player:0},{id:73,adjacent:[72,74],coordinates:[1136,922],player:0},{id:74,adjacent:[73],coordinates:[1164,950],player:0},{id:75,adjacent:[76],coordinates:[320,129],player:0},{id:76,adjacent:[75,77],coordinates:[353,163],player:0},{id:77,adjacent:[76,78],coordinates:[388,199],player:0},{id:78,adjacent:[77,79],coordinates:[421,233],player:0},{id:79,adjacent:[78,80],coordinates:[456,266],player:0},{id:80,adjacent:[79,81],coordinates:[490,300],player:0},{id:81,adjacent:[80,82],coordinates:[524,333],player:0},{id:82,adjacent:[81,83],coordinates:[557,367],player:0},{id:83,adjacent:[82,84],coordinates:[579,382],player:0},{id:84,adjacent:[83,85],coordinates:[610,388],player:0},{id:85,adjacent:[84,86],coordinates:[631,408],player:0},{id:86,adjacent:[85,87],coordinates:[656,432],player:0},{id:87,adjacent:[86,88],coordinates:[680,457],player:0},{id:88,adjacent:[87,13],coordinates:[699,486],player:0},{id:89,adjacent:[61,90],coordinates:[810,264],player:0},{id:90,adjacent:[89,91],coordinates:[796,178],player:0},{id:91,adjacent:[90,92],coordinates:[797,139],player:0},{id:92,adjacent:[91,93],coordinates:[797,101],player:0},{id:93,adjacent:[92],coordinates:[797,63],player:0},{id:94,adjacent:[55,95],coordinates:[915,591],player:0},{id:95,adjacent:[94,96],coordinates:[976,564],player:0},{id:96,adjacent:[95,97],coordinates:[977,526],player:0},{id:97,adjacent:[96,98],coordinates:[977,486],player:0},{id:98,adjacent:[61,97],coordinates:[976,446],player:0}],d(),h()},f=function(){for(var b=[],c=0;c<a.length;c++){var d=a[c];0===d.player&&b.push(d)}return b},g=function(){for(var c=[],d=0;d<a.length;d++){var e=a[d];e.player===b&&c.push(e)}return c},h=function(){var a=f(),c=a[Math.floor(Math.random()*a.length)];c.player=b},i=function(c,d){for(var e=0;e<a.length;e++)a[e].id===c.id&&(a[e].player=0),a[e].id===d.id&&"p1goal"!==a[e].player&&(a[e].player=b)},j=function(){b=1===b?2:1,h()},k=function(b){c++;for(var d=0;d<a.length;d++)a[d].id===b.id&&(a[d].player="p1goal")},l=function(){return 5===c?!0:!1};return{startNewGame:e,getGameBoard:function(){return a},getCurrentPlayer:function(){return b},getCurrentPlayersMonsters:g,placeRandomPieceForCurrentPlayer:h,moveMonsterFromTo:i,playerScored:k,getScore:function(){return c},changeTurn:j,checkForWin:l}}),angular.module("morningtonCrescentApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/main.html",'<div id="hud"> <div class="hud-item pointer" ng-click="startGame(); done = true;" href="#/">New Game</div> <div class="hud-item" ng-if="gameInProgress" ng-bind="currentPlayer === 1 ? \'Your Turn\' : \'AI\\\'s Turn\'"></div> <div class="hud-item" ng-if="gameInProgress"> Your Score: {{playerOneScore}} </div> <div class="hud-item pointer" ng-click="endTurn()" ng-if="gameInProgress">End Turn</div> </div> <div id="intro" ng-show="!done" ng-click="done = !done; startGame();"> </div> <div id="won" ng-show="justWonGame" ng-click="justWonGame = false"> <div class="won-text"> You won! The monsters take a moment from their viciousness to thank you :) <br>What would you like to do? </div> <div class="won-items"> <div class="won-item"> Continue </div> <div class="won-item" ng-click="startGame()"> Restart </div> </div> </div> <div id="board" ng-if="gameInProgress"> <div class="legal-space pointer" ng-repeat="space in legalMoves" ng-style="{ \'left\' : space.coordinates[0]-20+\'px\', \'top\' : space.coordinates[1]-20+\'px\', \'z-index\' : 99 }" ng-click="moveMonster(space)"></div> <div title="Portal" class="player-one-goal pulse animated infinite" ng-model="playerOneGoal" ng-style="{ \'left\' : playerOneGoal.coordinates[0]-20+\'px\', \'top\' : playerOneGoal.coordinates[1]-30+\'px\' }"></div> <div class="player-one-monster" ng-repeat="space in playerOneMonsters" ng-style="{ \'left\' : space.coordinates[0]-20+\'px\', \'top\' : space.coordinates[1]-20+\'px\' }"></div> <div class="player-two-monster" ng-repeat="space in playerTwoMonsters" ng-style="{ \'left\' : space.coordinates[0]-20+\'px\', \'top\' : space.coordinates[1]-20+\'px\' }"></div> <div class="pointer movable" ng-class="(currentPlayer === 1) ? \'player-one-movable bounce animated infinite\' : \'player-two-movable\'" ng-repeat="space in currentPlayerMovable" ng-style="{ \'left\' : space.coordinates[0]-20+\'px\', \'top\' : space.coordinates[1]-20+\'px\' }" ng-click="grabMonster(space)"> </div> </div>')}]);